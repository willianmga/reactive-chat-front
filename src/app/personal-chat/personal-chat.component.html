
<mat-sidenav-container class="main-sidenav-container" autosize>

    <mat-sidenav #chatsidenav mode="side" class="message-list-container" opened [fixedInViewport]="false" [fixedTopGap]="true" [fixedBottomGap]="true">

        <mat-card  class="message-list-container">
            <mat-card-header>
                <div>
                    <mat-form-field>
                        <mat-label>Search a contact</mat-label>
                        <input #searchinput matInput matNativeControl [matAutocomplete]="auto" placeholder="Type the contact name">
                        <mat-autocomplete #auto="matAutocomplete">
                            <mat-option *ngFor="let contact of contacts" value="{{contact.name}}">
                                {{contact.name}}
                            </mat-option>
                        </mat-autocomplete>
                    </mat-form-field>
        
                    <button mat-icon-button aria-label="Test">
                        <mat-icon>search</mat-icon>
                    </button> 
                </div>
            </mat-card-header>
        </mat-card>

        <nav>
            <mat-selection-list [multiple]="false">
                <mat-list-option *ngFor="let contact of contacts" (click)="openContact(contact)">
                    <img mat-list-avatar src="{{contact?.avatar}}"/>
                    <h1 matLine>{{contact.name}}</h1>
                    <h3 *ngIf="contact.chatHistory.length === 0"  matLine>{{contact.status}}</h3>
                    <h3 *ngIf="contact.chatHistory.length > 0" matLine style="font-weight: bold">{{contact.chatHistory[contact.chatHistory.length - 1]?.payload.content}}</h3>
                    <mat-divider></mat-divider>
                </mat-list-option>
                
            </mat-selection-list>  
        </nav>

    </mat-sidenav>

    <mat-sidenav-content class="main-sidenav-content">

        <mat-card class="message-card-container">

            <mat-card-header>                    
                <img mat-card-avatar src="{{contact?.avatar}}"/>        
                <mat-card-title>{{contact.name}}</mat-card-title>
                <mat-card-subtitle>{{contact.status}}</mat-card-subtitle>
            </mat-card-header>

            <mat-card-content class="message-area">

                <div class="message-area-container">

                    <table mat-table [dataSource]="messagesDataSource">
    
                        <ng-container matColumnDef="message">
                            <th mat-header-cell *matHeaderCellDef> Message </th>
                            <td mat-cell *matCellDef="let element"> {{element.payload.content}} </td>
                        </ng-container>
                    
                        <tr mat-row [style.text-align]="receivedMessage(row) ? 'left' : 'right'" style="color: black;" *matRowDef="let row; columns: displayedColumns;"></tr>
                    </table>
    
                </div>

            </mat-card-content>
            <mat-card-footer style="padding: 0px 50px;">

                <div class="message-type-area">
                    <mat-form-field hintLabel="Max 280 characters" appearance="fill">
                        <mat-label>Message</mat-label>
                        <input #messageinput matInput matNativeControl maxlength="280" placeholder="Type your message">
                        <mat-hint align="end">{{ messageinput.value?.length || 0 }}/280</mat-hint>
                    </mat-form-field>
        
                    <button mat-icon-button (click)="sendMessage(messageinput.value)" style="margin-left: 20px;">
                        <mat-icon [inline]="true" class="mediumIcon">send</mat-icon>
                    </button> 
                </div>   

            </mat-card-footer>

        </mat-card>

    </mat-sidenav-content>

</mat-sidenav-container>
